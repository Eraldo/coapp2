<ion-header>
  <ion-navbar color="area-4">
    <ion-title>Event</ion-title>
    <ion-buttons end>
      <button *ngIf="canJoin" ion-button icon-right (click)="join()">
        Join
        <ion-icon [name]="icons.JOIN"></ion-icon>
      </button>
    </ion-buttons>
  </ion-navbar>
</ion-header>

<ion-content>
  <ng-container *ngIf="event">
    <div class="media-header content" [class.includes-video]="event.videoUrl" *ngIf="event.imageUrl || event.videoUrl">
      <img *ngIf="!event.videoUrl && event.imageUrl" [src]="event.imageUrl">
      <embedded-video *ngIf="event.videoUrl" [videoUrl]="event.videoUrl" width="100%" height="100%"></embedded-video>
    </div>
    <ion-item>
      <h1>
        <ion-icon name="calendar"></ion-icon>
        {{ event.name }}
      </h1>
      <p>
        {{ event.start | date:'fullDate' }}
        <span *ngIf="event.location">@{{ event.location }}</span>
      </p>
      <p class="multiline">{{ event.description }}</p>
    </ion-item>
    <ion-item *ngIf="event.participants?.edges?.length">
      Participants
      <span item-right>
        <ng-container *ngFor="let edge of event.participants?.edges">
          <ion-avatar item-end *ngIf="edge.node as participant" class="stacked" (click)="navCtrl.push('LegendPage', {id: participant.id})">
            <img src="{{ participant.avatar }}">
          </ion-avatar>
        </ng-container>
      </span>
    </ion-item>
    <div padding class="content">
      <markdown [data]="event.content"></markdown>
    </div>
  </ng-container>
</ion-content>
